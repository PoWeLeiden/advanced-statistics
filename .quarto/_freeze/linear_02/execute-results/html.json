{
  "hash": "fdbd1d56d04fd3f472f19ad6e16276bf",
  "result": {
    "engine": "knitr",
    "markdown": "---\ncode-annotations: hover\ncitation-location: margin\n---\n\n\n\n# Bivariate Regressie met Binaire en Categorische Predictoren {#sec-binary-predictors}\n\n\n\n::: {.cell}\n\n:::\n\n\n\nIn het vorige hoofdstuk bespraken we hoe een lineaire regressieanalyse te gebruiken om de relatie tussen continue variabelen na te gaan. In dit hoofdstuk wordt uitgelegd hoe je een bivariate regressie kan uitvoeren met binaire en categorische variabelen.\n\nWe beginnen zoals gewoonlijk met het laden van relevante R packages ('libraries'). Deze packages zijn reeds geïnstalleerd op de universitaire computers, maar moeten eerst geladen worden. We laden ook onze dataset.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rio)             #laden van data\nlibrary(tidyverse)       #datamanipulatie en grafieken\nlibrary(broom)           #samenvattingen regressiemodellen\nlibrary(marginaleffects) #voorspelde waarden berekenen\n\ndemdata <- import(\"demdata.rds\") |> \n  as_tibble()\n```\n:::\n\n\n\n## Data Management: Converteren naar een factor variabele\n\nVia lineaire regressieanalyse kunnen we een continue afhankelijke variabele ook voorspellen aan de hand van binaire (2 waarden) en categorische (3 of meer waarden) variabelen.\n\nOm deze variabelen te gebruiken in een regressiemodel moeten ze toegevoegd worden als dichotome of \"[dummy](https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faqwhat-is-dummy-coding/){target=\"_blank\"}\" variabelen. Als de variabele binair is, wordt 1 dummy gebruikt, als de variabelen meer categorieën kent, worden meerdere dummies gebruikt.[^linear_02-1] R voegt automatisch dummies toe voor factor variabelen, dus transformeren we binaire en categorische variabelen naar factor variabelen voor we ze in een regressie analyse gebruiken.[^linear_02-2]\n\n[^linear_02-1]: We gebruiken k-1 dummies, waarbij k = aantal categorieën. Als een categorische variabele 4 categorieën heeft (Bijvoorbeeld: Noorden, Westen, Zuiden en Oosten), dan gebruiken we (4-1=) 3 dummies.\n\n[^linear_02-2]: Transformatie is niet nodig als de originele variabelen reeds opgeslaan zijn als factor in de dataset, maar misschien moet de referentiecategorie wel aangepast worden (zie verder).\n\nIn dit voorbeeld maken we gebruik van de variabele \"TYPEDEMO1984\". Deze binaire variabele toont of een land een democratie of autocratie was in het jaar 1984. De variabele is numeriek opgeslagen (dit kunnen we controleren met behulp van de functie `class()`). De waarde 1 staat voor autocratie, de waarde 2 voor democratie.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Informatie over type variabele: \nclass(demdata$TYPEDEMO1984)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"numeric\"\n```\n\n\n:::\n\n```{.r .cell-code}\n#simpele tabel\ntable(demdata$TYPEDEMO1984)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n 1  2 \n86 57 \n```\n\n\n:::\n:::\n\n\n\nAangezien de variabele numeriek is, transformeren we deze eerst naar een factor variabele. We kunnen dit doen met de ingebouwde `factor()` functie (zie [Statistiek I, 1.6.3](https://poweleiden.github.io/statistiek1/data_01_basics.html#creating-variables-in-r){target=\"_blank\"}) of met de `factorize()` functie afkomstig uit het `rio` package. Deze laatste functie is vooral handig als de waarden labels hebben zoals hier het geval is ( 1 = \"Autocratie\", 2 = \"Democratie\"). Als er geen labels zijn, moet je `factor()` gebruiken gezien `factorize()` in dat geval niet de juiste uitkomsten geeft. Zie @sec-not-seeing-the-right-number-of-categories-for-factor-variables-in-regression-models voor meer informatie.\n\nDe labels kun je zien met behulp van de `view_df()` functie uit het `sjPlot` package (zie @sec-recall-peeking-inside-data-objects) of door gebruik te maken van de ingebouwde functie `attributes()` (vooraleer je transformeert naar factor): `attributes(demdata$TYPEDEMO1984)`. Daarbij kijk je of er informatie is waar \"\\$labels\" staat.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nattributes(demdata$TYPEDEMO1984)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$label\n[1] \"Type of democracy, 1984\"\n\n$format.stata\n[1] \"%10.0g\"\n\n$labels\nAutocracies Democracies \n          1           2 \n```\n\n\n:::\n:::\n\n\n\nWe gebruiken `factorize()` gezien de waarden van onze variabelen labels hebben (1 = \"Autocratie\", 2 = \"Democratie\"). We kijken ook na of de functie gelukt is.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# transformeren naar factor\ndemdata <- demdata |> \n  mutate(TYPEDEMO1984_factor = factorize(TYPEDEMO1984))\n\n#Niveaus (levels) bekijken en tabel om te checken\nlevels(demdata$TYPEDEMO1984_factor)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Autocracies\" \"Democracies\"\n```\n\n\n:::\n\n```{.r .cell-code}\ntable(demdata$TYPEDEMO1984_factor)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nAutocracies Democracies \n         86          57 \n```\n\n\n:::\n:::\n\n\n\nDe syntax is eenvoudig:\n\n`factorize(`\n\n:   Naam van de functie die wordt toegepast op de variabele tussen haakjes.\n\n`TYPEDEMO1984`\n\n:   Aangeduide variabele. Het laagste numerieke niveau van deze variabele zal als eerste niveau van de factor gebruikt worden en dus als referentiecategorie.\n\nDezelfde procedure wordt gehanteerd voor een categorische variabele met 3 of meer categorieën. Bijvoorbeeld, de variabele `Typeregime2006` geeft weer of een land een liberale democratie was (=1), een electorale democratie (=2), of een autocratie (=3) in het jaar 2006. Deze variabele heeft ook waarden-labels dus kunnen we opnieuw `factorize()` gebruiken:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#transformeer naar factor variabele\ndemdata <- demdata |> \n  mutate(Typeregime2006_factor = factorize(Typeregime2006))\n\n#Werk checken\nlevels(demdata$Typeregime2006_factor)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Liberal democracy\"   \"Electoral democracy\" \"Autocracy\"          \n```\n\n\n:::\n\n```{.r .cell-code}\ntable(demdata$Typeregime2006_factor)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  Liberal democracy Electoral democracy           Autocracy \n                 71                  53                  41 \n```\n\n\n:::\n:::\n\n\n\n::: callout-warning\n#### Waarschuwing!\n\nWe raden aan om nieuwe variabelen aan te maken wanneer je een bestaande variabele omzet naar een factorvariabele (of wanneer je hercodeert) zoals hiervoven (bv., `mutate(TYPEDEMO1984_factor = factorize(TYPEDEMO1984))`). Als je een nieuwe variabele aanmaakt, overschrijf je nooit de originele. Dit kan helpen om fouten makkelijker te corrigeren (zonder dat je dataset opnieuw moet inladen en eerdere syntax runnen).\n:::\n\n### Veranderen van de referentiecategorie {#sec-relevelling}\n\n`factorize()` gebruikt de eerste numerieke waarde als referentiegroep bij het maken van een factorvariabele. `factor()` doet dit ook, tenzij we expliciet de volgorde van de factorniveaus (levels) aanduiden in de syntax (zie het voorbeeld in @sec-not-seeing-the-right-number-of-categories-for-factor-variables-in-regression-models). \n\nIn elk geval kunnen we de referentiecategorie veranderen als we dat willen. Dit kunnen we doen met behulp van de `relevel()` functie. Hieronder veranderen we de referentiecategorie voor \"Typeregime2006_factor\" naar \"Electoral Democracy\".\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndemdata <- demdata |> \n  mutate(Typeregime2006_factor_relevel = relevel(Typeregime2006_factor, \"Electoral democracy\"))\n```\n:::\n\n\n\n`relevel(`\n\n:   Naam van de functie\n\n`Typeregime2006_factor,`\n\n:   We gebruiken \"Typeregime2006_factor\" uit de \"demdata\" dataset.\n\n`\"Electoral democracy\")`\n\n:   We geven de naam op van de categorie die we als referentiecategorie willen nemen tussen dubbele aanhalingstekens. We gebruiken de naam tussen aanhalingstekens omdat de variabele reeds hierboven naar een factor is omgezet, anders zou dit niet werken.\n\nWe checken altijd beter of alles goed is gegaan:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Checken:\nlevels(demdata$Typeregime2006_factor)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Liberal democracy\"   \"Electoral democracy\" \"Autocracy\"          \n```\n\n\n:::\n\n```{.r .cell-code}\nlevels(demdata$Typeregime2006_factor_relevel)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Electoral democracy\" \"Liberal democracy\"   \"Autocracy\"          \n```\n\n\n:::\n:::\n\n\n\n## Factor variabelen als predictoren\n\nWe voegen binaire en categorische onafhankelijke variabelen toe aan de regressieanalyse op dezelfde manier als bij continue variabelen:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Met binaire predictor: \nmodel_binary <- lm(v2x_polyarchy ~ TYPEDEMO1984_factor, data=demdata)\nsummary(model_binary)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = v2x_polyarchy ~ TYPEDEMO1984_factor, data = demdata)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.51025 -0.15007 -0.00857  0.17309  0.48543 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                     0.41757    0.02333   17.90  < 2e-16 ***\nTYPEDEMO1984_factorDemocracies  0.27268    0.03695    7.38 1.25e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2163 on 141 degrees of freedom\n  (36 observations deleted due to missingness)\nMultiple R-squared:  0.2786,\tAdjusted R-squared:  0.2735 \nF-statistic: 54.47 on 1 and 141 DF,  p-value: 1.247e-11\n```\n\n\n:::\n\n```{.r .cell-code}\n# Met categorische predictor: \nmodel_categorical <- lm(v2x_polyarchy ~ Typeregime2006_factor, data=demdata)\nsummary(model_categorical)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = v2x_polyarchy ~ Typeregime2006_factor, data = demdata)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.40104 -0.09898  0.00196  0.10773  0.47773 \n\nCoefficients:\n                                         Estimate Std. Error t value Pr(>|t|)\n(Intercept)                               0.75404    0.01734   43.48   <2e-16\nTyperegime2006_factorElectoral democracy -0.32106    0.02653  -12.10   <2e-16\nTyperegime2006_factorAutocracy           -0.50577    0.02866  -17.64   <2e-16\n                                            \n(Intercept)                              ***\nTyperegime2006_factorElectoral democracy ***\nTyperegime2006_factorAutocracy           ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1461 on 162 degrees of freedom\n  (14 observations deleted due to missingness)\nMultiple R-squared:  0.6789,\tAdjusted R-squared:  0.6749 \nF-statistic: 171.2 on 2 and 162 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n::: callout-note\n#### Output uitleg\n\nDe output van een model met binaire/categorische predictor is dezelfde als die van een model met een continue predictor met 1 verschil. R zal de variabelenaam bij de coëfficiënten anders weergeven als er een factor variabele is. Dan krijg je de naam van de variabele, onmiddellijk gevolgd door de categorie die de waarde 1 aanneemt in de dummy. Bijvoorbeeld: \"TypeDemo1984_factorDemocracies\" or \"Typeregime2006_factorAutocracy.\"\n:::\n\nEr zijn subtiele verschillen in de interpretatie als een factor variabele opgenomen wordt in het model:\n\n::: callout-warning\n#### Interpretatie\n\nDe `Estimate` kolom toont de coëfficiënten van het regressiemodel.\n\nHet\"(Intercept)\" toont nog steeds de verwachte waarde op de afhankelijke variabele als de onafhankelijke variabele gelijk is aan 0. Als de enige onafhankelijke variabele een factor is dan toont het intercept de gemiddelde waarde op Y voor de referentiegroep (factor dummy = 0).\n\nHier vinden we dat de gemiddelde waarde voor `v2x_polyarchy` voor autocratieën (gemeten volgens de `TYPEDEMO1984_factor` variabele) gelijk is aan het Intercept dat we hierboven vonden.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndemdata |> \n  filter(TYPEDEMO1984_factor == \"Autocracies\") |> # <1> \n  summarize(mean_democracy = mean(v2x_polyarchy, na.rm=T)) |> \n  as.data.frame() # <2>\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  mean_democracy\n1      0.4175698\n```\n\n\n:::\n:::\n\n\n\n1.  De filter verwijdert observaties die niet de waarde \"Autocracies\" hebben voor TYPEDEMO1984_factor\n2.  Deze optie dwingt R om alle decimalen weer te geven voor een betere vergelijking met het Intercept.\n\nDe coëfficiënten voor binaire en categorische variabelen worden best gezien als het verschil in de gemiddelde score voor Y tussen de referentiecategorie en andere categorieën. De coëfficiënt voor \"TYPEDEMO1984_factorDemocracies\" is bijvoorbeeld 0.2726758.[^linear_02-3] Dit betekent dat de gemiddelde score op Y voor democratieën 0.2726758 schaalpunten groter is dan de gemiddelde waarde voor autocratieën (de referentiecategorie).\n\nWe kunnen dit wiskundig nagaan:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Gemiddelde voor democratieën\ndemdata |> \n  group_by(TYPEDEMO1984_factor) |> \n  summarize(mean_democracy = mean(v2x_polyarchy, na.rm = T)) |>\n  as.data.frame() \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  TYPEDEMO1984_factor mean_democracy\n1         Autocracies      0.4175698\n2         Democracies      0.6902456\n3                <NA>      0.4638056\n```\n\n\n:::\n\n```{.r .cell-code}\n# gemiddelde democratieën - gemiddelde autocratieën\n 0.6902456 - 0.4175698\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.2726758\n```\n\n\n:::\n:::\n\n\n\nHetzelfde geldt voor categorische factorvariabelen. De \"(Intercept)\" waarde in `model_categorical` is de gemiddelde waarde voor de observaties in de referentiecategorie (hier: \"Liberal Democracy\"). De coefficiënten tonen hoe de andere groepen verschillen van dit gemiddelde. De gemiddelde 2020 democratiescore voor landen die in 2006 een \"Electoral Democracy\" waren is -0.32 schaalpunten lager dan de gemiddelde 2020 democratiescore voor de \"Liberal Democracy\" referentiegroep.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndemdata |> \n  group_by(Typeregime2006_factor) |> \n  summarize(mean_democracy = mean(v2x_polyarchy, na.rm=T)) |> \n  as.data.frame() \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Typeregime2006_factor mean_democracy\n1     Liberal democracy      0.7540423\n2   Electoral democracy      0.4329811\n3             Autocracy      0.2482683\n4                  <NA>      0.3777143\n```\n\n\n:::\n\n```{.r .cell-code}\n# gemiddelde Elec Democracy - gemiddelde in Lib Democracy\n0.4329811 - 0.7540423\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -0.3210612\n```\n\n\n:::\n\n```{.r .cell-code}\n# gemiddelde in Autocracy - gemiddelde in Lib Democracy\n0.2482683 - 0.7540423\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -0.505774\n```\n\n\n:::\n:::\n\n\n\nZie @sec-reporting-linear-regression voor verdere informatie over hoe de resultaten te presenteren in taken en papers.\n:::\n\n[^linear_02-3]: Normaal ronden we af op 2 of 3 decimalen, maar hier tonen we de hele coëfficiënt zodat deze beter vergeleken kan worden met het verschil tussen de gemiddelden.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}